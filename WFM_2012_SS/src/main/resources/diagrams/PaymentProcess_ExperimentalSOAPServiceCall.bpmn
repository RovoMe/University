<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" 
			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
			xmlns:activiti="http://activiti.org/bpmn" 
			xmlns:tns="http://www.activiti.org/test"
			xmlns:coupon="http://couponValidation.ws.wfm"
			xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" 
			xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" 
			xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" 
			typeLanguage="http://www.w3.org/2001/XMLSchema" 
			expressionLanguage="http://www.w3.org/1999/XPath" 
			targetNamespace="http://www.activiti.org/test">

  <import location="http://localhost:63081/CouponValidationService?wsdl" namespace="http://couponValidation.ws.wfm" importType="http://schemas.xmlsoap.org/wsdl/"/>
  
  <message id="validateCouponRequestMessage" itemRef="tns:validateCouponRequestItem" />
  <message id="validateCouponResponseMessage" itemRef="tns:validateCouponResponseItem" />
  
  <itemDefinition id="validateCouponRequestItem" structureRef="coupon:validateCoupon" />
  <itemDefinition id="validateCouponResponseItem" structureRef="coupon:validateCouponResponse" />
  
  <interface name="AddressValidation interface" implementationRef="coupon:CouponValidationService">
	<operation id="validateCouponOperation" name="validateCoupon operation" implementationRef="coupon:validateCoupon">
	  <inMessageRef>tns:validateCouponRequestMessage</inMessageRef>
	  <outMessageRef>tns:validateCouponResponseMessage</outMessageRef>
	</operation>
  </interface>
  
  <itemDefinition id="hash" structureRef="string" />
  <itemDefinition id="couponHash" structureRef="string" />
  <itemDefinition id="priceReduction" structureRef="xsi:double" />
  <itemDefinition id="couponValue" structureRef="xsi:double" />

  <process id="OnlinePaymentProcess" name="Online Payment Process">
    <startEvent id="startevent1" name="Start">
      <extensionElements>
        <activiti:formProperty id="price" name="Price" type="long" required="true"></activiti:formProperty>
      </extensionElements>
    </startEvent>
    <subProcess id="paymentProcess" name="Payment Process">
      <startEvent id="startevent2" name="Start"></startEvent>
      <userTask id="getAddress" name="get address" activiti:assignee="kermit" activiti:formKey="addressForm.jsf">
        <documentation>Name and Address required for Ordering</documentation>
      </userTask>
      <subProcess id="addressValidation" name="Address Validation">
        <startEvent id="startevent3" name="Start"></startEvent>
        <endEvent id="endevent2" name="End"></endEvent>
	    <serviceTask id="validateAddress" name="validate address" activiti:class="wfm.activiti.AddressValidationWSBehavior">
          <extensionElements>
            <activiti:executionListener event="start" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
            <activiti:executionListener event="end" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
            <activiti:field name="service">
              <activiti:string>http://localhost:63082</activiti:string>
            </activiti:field>
            <activiti:field name="firstName">
              <activiti:expression>${firstName}</activiti:expression>
            </activiti:field>
            <activiti:field name="lastName">
              <activiti:expression>${lastName}</activiti:expression>
            </activiti:field>
            <activiti:field name="street">
              <activiti:expression>${street}</activiti:expression>
            </activiti:field>
            <activiti:field name="zip">
              <activiti:expression>${zip}</activiti:expression>
            </activiti:field>
            <activiti:field name="city">
              <activiti:expression>${city}</activiti:expression>
            </activiti:field>
            <activiti:field name="country">
              <activiti:expression>${country}</activiti:expression>
            </activiti:field>
            <activiti:field name="telNo">
              <activiti:expression>${telNo}</activiti:expression>
            </activiti:field>
            <activiti:field name="mailAddress">
              <activiti:expression>${mailAddress}</activiti:expression>
            </activiti:field>
          </extensionElements>
        </serviceTask>
        <exclusiveGateway id="exclusivegateway7" name="Exclusive Gateway"></exclusiveGateway>
        <endEvent id="AddressValidationErrorEndEvent" name="ErrorEnd">
          <errorEventDefinition errorRef="AddressValidationError"></errorEventDefinition>
        </endEvent>
      </subProcess>
      <boundaryEvent id="AddressValidationBoundaryErrorEvent" name="AddressValidationBoundaryErrorEvent" cancelActivity="true" attachedToRef="addressValidation">
        <errorEventDefinition errorRef="AddressValidationError"></errorEventDefinition>
      </boundaryEvent>
      <scriptTask id="resetAddressForm" name="reset" scriptFormat="groovy">
        <script><![CDATA[out:println 'ERROR: '+addressValidationError
execution.setVariable('firstName', '')
execution.setVariable('lastName', '')
execution.setVariable('street', '')
execution.setVariable('zip', '')
execution.setVariable('city', '')
execution.setVariable('country', '')
execution.setVariable('telNo', '')
execution.setVariable('mailAddress', '')
execution.removeVariable('addressValidationError')]]></script>
      </scriptTask>
      <parallelGateway id="parallelgateway1" name="Parallel Gateway"></parallelGateway>
      <userTask id="getPaymentModalities" name="get payment modalities" activiti:assignee="kermit" activiti:formKey="paymentModalitiesForm.jsf"></userTask>
      <userTask id="getCoupon" name="get coupon" activiti:assignee="kermit" activiti:formKey="couponForm.jsf"></userTask>
      <subProcess id="couponValidation" name="Coupon Validation">
        <startEvent id="startevent4" name="Start"></startEvent>
        <endEvent id="endevent4" name="End"></endEvent>
        <exclusiveGateway id="exclusivegateway2" name="Exclusive Gateway"></exclusiveGateway>
        <exclusiveGateway id="exclusivegateway3" name="Exclusive Gateway"></exclusiveGateway>
        <!-- 
        <serviceTask id="validateCoupon" name="validate coupon" activiti:class="wfm.activiti.CouponValidationWSBehavior">
          <extensionElements>
            <activiti:field name="service">
              <activiti:string>http://localhost:63081/CouponValidationService/validateCoupon</activiti:string>
            </activiti:field>
            <activiti:field name="hash">
              <activiti:expression>${hash}</activiti:expression>
            </activiti:field>
          </extensionElements>
        </serviceTask>
        -->
      <serviceTask id="validateCoupon" name="validate coupon" implementation="##WebService" operationRef="tns:validateCouponOperation">
      	<ioSpecification>
      	  <dataInput itemSubjectRef="tns:validateCouponRequestItem" id="dataInput" />
      	  <dataOutput itemSubjectRef="tns:validateCouponResponseItem" id="dataOutput" />
      	  <inputSet>
		    <dataInputRefs>dataInput</dataInputRefs>
		  </inputSet>
		  <outputSet>
		    <dataOutputRefs>dataOutput</dataOutputRefs>
		  </outputSet>
      	</ioSpecification>
      	
      	<dataInputAssociation>
      	  <sourceRef>hash</sourceRef>
		  <targetRef>couponHash</targetRef>
		</dataInputAssociation>
		
		<dataOutputAssociation>
		  <sourceRef>priceReduction</sourceRef>
		  <targetRef>couponValue</targetRef>
		</dataOutputAssociation>
      </serviceTask>
      
        <scriptTask id="calculateNewPrice" name="calculate new price" scriptFormat="groovy">
          <script><![CDATA[execution.setVariable('price', price-couponValue)
out:println 'New price: ' + price]]></script>
        </scriptTask>
        <exclusiveGateway id="exclusivegateway6" name="Exclusive Gateway"></exclusiveGateway>
        <scriptTask id="couponValidationErrorReport" name="report validation error" scriptFormat="groovy">
          <extensionElements>
            <activiti:executionListener event="start" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
            <activiti:executionListener event="end" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
          </extensionElements>
          <script><![CDATA[execution.setVariable('couponValidationError', 'No coupon found for hash '+hash)]]></script>
        </scriptTask>
        <endEvent id="CouponValidationErrorEndEvent" name="ErrorEnd">
          <errorEventDefinition errorRef="CouponValidationError"></errorEventDefinition>
        </endEvent>
      </subProcess>
      <boundaryEvent id="CouponValidationBoundaryErrorEvent" name="CouponValidationBoundaryErrorEvent" cancelActivity="true" attachedToRef="couponValidation">
        <errorEventDefinition errorRef="CouponValidationError"></errorEventDefinition>
      </boundaryEvent>
      <scriptTask id="resetCouponForm" name="reset" scriptFormat="groovy">
        <script><![CDATA[out:println 'ERROR: '+ couponValidationError
execution.setVariable('hash', '')
execution.removeVariable('couponValidationError')]]></script>
      </scriptTask>
      <parallelGateway id="parallelgateway2" name="Parallel Gateway"></parallelGateway>
      <endEvent id="endevent5" name="End"></endEvent>
      <subProcess id="paymentValidation" name="Payment Validation">
        <startEvent id="startevent5" name="Start"></startEvent>
        <endEvent id="endevent6" name="End"></endEvent>
        <exclusiveGateway id="exclusivegateway4" name="Exclusive Gateway"></exclusiveGateway>
        <exclusiveGateway id="exclusivegateway5" name="Exclusive Gateway"></exclusiveGateway>
        <userTask id="getBankTransferData" name="get bank transfer data" activiti:assignee="kermit" activiti:formKey="bankAccountForm.jsf"></userTask>
        <userTask id="getCreditCardData" name="get credit card data" activiti:assignee="kermit" activiti:formKey="creditCardForm.jsf"></userTask>
        <serviceTask id="validateBankTransferData" name="validate bank transfer data" activiti:class="wfm.activiti.BankTransferValidationWSBehavior">
          <extensionElements>
            <activiti:executionListener event="start" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
            <activiti:executionListener event="end" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
            <activiti:field name="service">
              <activiti:string>http://localhost:63084/BankTransferValidationService/validateBankAccount</activiti:string>
            </activiti:field>
            <activiti:field name="successPath">
              <activiti:string>successBankTransferValidation</activiti:string>
            </activiti:field>
            <activiti:field name="errorPath">
              <activiti:string>errorBankTransferValidation</activiti:string>
            </activiti:field>
            <activiti:field name="bankName">
              <activiti:expression>${bankName}</activiti:expression>
            </activiti:field>
            <activiti:field name="bankCode">
              <activiti:expression>${bankCode}</activiti:expression>
            </activiti:field>
            <activiti:field name="accountNumber">
              <activiti:expression>${accountNumber}</activiti:expression>
            </activiti:field>
            <activiti:field name="holdersName">
              <activiti:expression>${holdersName}</activiti:expression>
            </activiti:field>
          </extensionElements>
        </serviceTask>
        <endEvent id="bankTransferValidationErrorEndEvent" name="ErrorEnd">
          <errorEventDefinition errorRef="PaymentValidationError"></errorEventDefinition>
        </endEvent>
        <serviceTask id="validateCreditCardData" name="validate credit card data" activiti:class="wfm.activiti.CreditCardValidationWSBehavior">
          <extensionElements>
            <activiti:executionListener event="start" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
            <activiti:executionListener event="end" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
            <activiti:field name="service">
              <activiti:string>http://localhost:63083</activiti:string>
            </activiti:field>
            <activiti:field name="successPath">
              <activiti:string>successCreditCardValidation</activiti:string>
            </activiti:field>
            <activiti:field name="errorPath">
              <activiti:string>errorCreditCardValidation</activiti:string>
            </activiti:field>
            <activiti:field name="cardNumber">
              <activiti:expression>${cardNumber}</activiti:expression>
            </activiti:field>
            <activiti:field name="cardType">
              <activiti:expression>${cardType}</activiti:expression>
            </activiti:field>
            <activiti:field name="expirationDate">
              <activiti:expression>${expirationDate}</activiti:expression>
            </activiti:field>
            <activiti:field name="nameOfOwner">
              <activiti:expression>${nameOfOwner}</activiti:expression>
            </activiti:field>
            <activiti:field name="CVV2Code">
              <activiti:expression>${CVV2Code}</activiti:expression>
            </activiti:field>
          </extensionElements>
        </serviceTask>
        <endEvent id="creditCardValidationErrorEndEvent" name="ErrorEnd">
          <errorEventDefinition errorRef="PaymentValidationError"></errorEventDefinition>
        </endEvent>
      </subProcess>
      <boundaryEvent id="PaymentValidationBoundaryErrorEvent" name="PaymentValidationBoundaryErrorEvent" cancelActivity="true" attachedToRef="paymentValidation">
        <errorEventDefinition errorRef="PaymentValidationError"></errorEventDefinition>
      </boundaryEvent>
      <scriptTask id="resetPaymentValidation" name="reset" scriptFormat="groovy">
        <script><![CDATA[out:println 'ERROR: ' + paymentValidationError
if (paymentMethod == 'bankTransferMethod') {
  execution.setVariable('bankName', '')
  execution.setVariable('bankCode', '')
  execution.setVariable('accountNumber', '')
  execution.setVariable('holdersName', '')
} else if (paymentMethod == 'creditCardMethod') {
  execution.setVariable('cardNumber', '')
  execution.setVariable('cardType', '')
  execution.setVariable('expirationDate', '')
  execution.setVariable('CVV2Code', '')
  execution.setVariable('nameOfOwner', '')
}
execution.removeVariable('paymentValidationError')]]></script>
      </scriptTask>
      <scriptTask id="debugOutput" name="debug output" scriptFormat="groovy">
        <script><![CDATA[def name = customer.getFirstName() + ' ' +customer.getLastName()
execution.setVariable('name',name)
def address = customer.getAddress().getStreet()+', '+customer.getAddress().getZip()+' '+customer.getAddress().getCity()+', '+customer.getAddress().getCountry()
def telNo = customer.getTelNo()
def mailAddress = customer.getMailAddress()
out:println '\nRESULT:'
out:println 'Name: ' + name
out:println 'Address: ' + address
out:println 'Telephone: ' + telNo
out:println 'EMail Address: ' + mailAddress
if (paymentMethod == 'bankTransferMethod') {
  def bank = BankAccount.getBankName()+', '+BankAccount.getBankCode()+', '+BankAccount.getAccountNumber()+', '+BankAccount.getHoldersName()
  out:println 'Bank data: '+bank
} else if (paymentMethod == 'creditCardMethod') {
  def creditCard = creditCard.getCardNumber()+', '+creditCard.getCardType()+', '+creditCard.getExpirationDate()+', '+creditCard.getCVV2Code()+', '+creditCard.getNameOfOwner()
  out:println 'Credit card data: ' +creditCard
} else {
  out:println 'Billing address: '+address
}
out:println 'Price: ' + price + ' Euro']]></script>
      </scriptTask>
      <userTask id="getAcknowledgement" name="get acknowledgement" activiti:assignee="kermit" activiti:formKey="acknowledgeForm.jsf"></userTask>
      <exclusiveGateway id="exclusivegateway8" name="Exclusive Gateway"></exclusiveGateway>
      <exclusiveGateway id="exclusivegateway9" name="Exclusive Gateway"></exclusiveGateway>
      <serviceTask id="sendOrderNotification" name="send order notification" activiti:class="wfm.activiti.MailNotificationBehavior"></serviceTask>
      <subProcess id="payment" name="Payment">
        <serviceTask id="retrievePaymentAcknowledgement" name="retrieve payment acknowledgement" activiti:class="wfm.activiti.PaymentAcknowledgementWSBehavior">
          <extensionElements>
            <activiti:executionListener event="end" class="wfm.activiti.WfmTaskListener"></activiti:executionListener>
            <activiti:field name="service">
              <activiti:string>http://localhost:63085/PaymentService</activiti:string>
            </activiti:field>
          </extensionElements>
        </serviceTask>
        <startEvent id="startevent6" name="Start"></startEvent>
        <endEvent id="paymentErrorEndEvent" name="ErrorEnd">
          <errorEventDefinition errorRef="PaymentError"></errorEventDefinition>
        </endEvent>
        <endEvent id="endevent9" name="End"></endEvent>
        <exclusiveGateway id="exclusivegateway10" name="Exclusive Gateway"></exclusiveGateway>
      </subProcess>
      <boundaryEvent id="PaymentBoundaryErrorEvent" name="PaymentBoundaryErrorEvent" cancelActivity="true" attachedToRef="payment">
        <errorEventDefinition errorRef="PaymentError"></errorEventDefinition>
      </boundaryEvent>
      <endEvent id="endevent10" name="End"></endEvent>
      <sequenceFlow id="flow2" name="" sourceRef="startevent2" targetRef="getAddress"></sequenceFlow>
      <sequenceFlow id="flow3" name="" sourceRef="getAddress" targetRef="addressValidation"></sequenceFlow>
      <sequenceFlow id="flow5" name="" sourceRef="resetAddressForm" targetRef="getAddress"></sequenceFlow>
      <sequenceFlow id="flow7" name="" sourceRef="addressValidation" targetRef="parallelgateway1"></sequenceFlow>
      <sequenceFlow id="flow8" name="" sourceRef="parallelgateway1" targetRef="getPaymentModalities"></sequenceFlow>
      <sequenceFlow id="flow9" name="" sourceRef="parallelgateway1" targetRef="getCoupon"></sequenceFlow>
      <sequenceFlow id="flow10" name="" sourceRef="getCoupon" targetRef="couponValidation"></sequenceFlow>
      <sequenceFlow id="flow19" name="" sourceRef="resetCouponForm" targetRef="getCoupon"></sequenceFlow>
      <sequenceFlow id="flow20" name="" sourceRef="getPaymentModalities" targetRef="parallelgateway2"></sequenceFlow>
      <sequenceFlow id="flow21" name="" sourceRef="couponValidation" targetRef="parallelgateway2"></sequenceFlow>
      <sequenceFlow id="flow30" name="" sourceRef="parallelgateway2" targetRef="paymentValidation"></sequenceFlow>
      <sequenceFlow id="flow34" name="" sourceRef="resetPaymentValidation" targetRef="paymentValidation"></sequenceFlow>
      <sequenceFlow id="flow35" name="" sourceRef="paymentValidation" targetRef="debugOutput"></sequenceFlow>
      <sequenceFlow id="flow36" name="" sourceRef="debugOutput" targetRef="getAcknowledgement"></sequenceFlow>
      <sequenceFlow id="flow40" name="" sourceRef="getAcknowledgement" targetRef="exclusivegateway8"></sequenceFlow>
      <sequenceFlow id="flow41" name="${paymentMethod == 'billingMethod'}" sourceRef="exclusivegateway8" targetRef="exclusivegateway9">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${paymentMethod == 'billingMethod'}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow42" name="" sourceRef="exclusivegateway9" targetRef="sendOrderNotification"></sequenceFlow>
      <sequenceFlow id="flow43" name="" sourceRef="sendOrderNotification" targetRef="endevent5"></sequenceFlow>
      <sequenceFlow id="flow44" name="" sourceRef="exclusivegateway8" targetRef="payment">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${paymentMethod != 'billingMethod'}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow49" name="" sourceRef="payment" targetRef="exclusivegateway9"></sequenceFlow>
    </subProcess>
    <endEvent id="endevent7" name="End"></endEvent>
    <sequenceFlow id="flow52" name="" sourceRef="couponValidationErrorReport" targetRef="CouponValidationErrorEndEvent"></sequenceFlow>
    <sequenceFlow id="flow45" name="" sourceRef="startevent6" targetRef="retrievePaymentAcknowledgement"></sequenceFlow>
    <sequenceFlow id="errorPayment" name="error" sourceRef="exclusivegateway10" targetRef="paymentErrorEndEvent">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${paymentError != ""}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="successPayment" name="" sourceRef="exclusivegateway10" targetRef="endevent9">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${paymentError == ""}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow48" name="" sourceRef="retrievePaymentAcknowledgement" targetRef="exclusivegateway10"></sequenceFlow>
    <sequenceFlow id="flow39" name="" sourceRef="validateAddress" targetRef="exclusivegateway7"></sequenceFlow>
    <sequenceFlow id="flow38" name="" sourceRef="validateCoupon" targetRef="exclusivegateway6"></sequenceFlow>
    <sequenceFlow id="successCreditCardValidation" name="success" sourceRef="validateCreditCardData" targetRef="exclusivegateway5"></sequenceFlow>
    <sequenceFlow id="errorCreditCardValidation" name="error" sourceRef="validateCreditCardData" targetRef="creditCardValidationErrorEndEvent"></sequenceFlow>
    <sequenceFlow id="creditCardMethod" name="creditCardMethod" sourceRef="exclusivegateway4" targetRef="getCreditCardData">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${paymentMethod == 'creditCardMethod' }]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow24" name="" sourceRef="startevent5" targetRef="exclusivegateway4"></sequenceFlow>
    <sequenceFlow id="flow25" name="" sourceRef="exclusivegateway5" targetRef="endevent6"></sequenceFlow>
    <sequenceFlow id="flow26" name="" sourceRef="getBankTransferData" targetRef="validateBankTransferData"></sequenceFlow>
    <sequenceFlow id="bankTransferMethod" name="bankTransferMethod" sourceRef="exclusivegateway4" targetRef="getBankTransferData">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${paymentMethod == 'bankTransferMethod'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="errorBankTransferValidation" name="error" sourceRef="validateBankTransferData" targetRef="bankTransferValidationErrorEndEvent"></sequenceFlow>
    <sequenceFlow id="successBankTransferValidation" name="success" sourceRef="validateBankTransferData" targetRef="exclusivegateway5"></sequenceFlow>
    <sequenceFlow id="flow31" name="" sourceRef="getCreditCardData" targetRef="validateCreditCardData"></sequenceFlow>
    <sequenceFlow id="billingMethod" name="billingMethod" sourceRef="exclusivegateway4" targetRef="exclusivegateway5">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${paymentMethod == 'billingMethod'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow6" name="" sourceRef="startevent3" targetRef="validateAddress"></sequenceFlow>
    <sequenceFlow id="successAddressValidation" name="" sourceRef="exclusivegateway7" targetRef="endevent2">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${customer != null}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="errorAddressValidation" name="${customer == null}" sourceRef="exclusivegateway7" targetRef="AddressValidationErrorEndEvent">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${customer == null}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow11" name="" sourceRef="startevent4" targetRef="exclusivegateway2"></sequenceFlow>
    <sequenceFlow id="hasNoHash" name="${hash == ''}" sourceRef="exclusivegateway2" targetRef="exclusivegateway3">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${hash == ''}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow13" name="" sourceRef="exclusivegateway3" targetRef="endevent4"></sequenceFlow>
    <sequenceFlow id="hasHash" name="${hash != ''}" sourceRef="exclusivegateway2" targetRef="validateCoupon">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${hash != ''}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="errorCouponValidation" name="${couponValue == 0}" sourceRef="exclusivegateway6" targetRef="couponValidationErrorReport">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${couponValue == 0}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="successCouponValidation" name="" sourceRef="exclusivegateway6" targetRef="calculateNewPrice">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${couponValue != 0}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow17" name="" sourceRef="calculateNewPrice" targetRef="exclusivegateway3"></sequenceFlow>
    <sequenceFlow id="flow1" name="" sourceRef="startevent1" targetRef="paymentProcess"></sequenceFlow>
    <sequenceFlow id="flow4" name="" sourceRef="AddressValidationBoundaryErrorEvent" targetRef="resetAddressForm"></sequenceFlow>
    <sequenceFlow id="flow18" name="" sourceRef="CouponValidationBoundaryErrorEvent" targetRef="resetCouponForm"></sequenceFlow>
    <sequenceFlow id="flow33" name="" sourceRef="PaymentValidationBoundaryErrorEvent" targetRef="resetPaymentValidation"></sequenceFlow>
    <sequenceFlow id="flow37" name="" sourceRef="paymentProcess" targetRef="endevent7"></sequenceFlow>
    <sequenceFlow id="flow53" name="" sourceRef="PaymentBoundaryErrorEvent" targetRef="endevent10"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_OnlinePaymentProcess">
    <bpmndi:BPMNPlane bpmnElement="OnlinePaymentProcess" id="BPMNPlane_OnlinePaymentProcess">
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35" width="35" x="10" y="318"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="paymentProcess" id="BPMNShape_paymentProcess" isExpanded="true">
        <omgdc:Bounds height="611" width="2811" x="120" y="30"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent2" id="BPMNShape_startevent2">
        <omgdc:Bounds height="35" width="35" x="140" y="260"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getAddress" id="BPMNShape_getAddress">
        <omgdc:Bounds height="55" width="105" x="230" y="250"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="addressValidation" id="BPMNShape_addressValidation" isExpanded="true">
        <omgdc:Bounds height="205" width="351" x="400" y="175"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent3" id="BPMNShape_startevent3">
        <omgdc:Bounds height="35" width="35" x="420" y="262"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent2" id="BPMNShape_endevent2">
        <omgdc:Bounds height="35" width="35" x="690" y="262"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="validateAddress" id="BPMNShape_validateAddress">
        <omgdc:Bounds height="55" width="105" x="490" y="252"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway7" id="BPMNShape_exclusivegateway7">
        <omgdc:Bounds height="40" width="40" x="610" y="259"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="AddressValidationErrorEndEvent" id="BPMNShape_AddressValidationErrorEndEvent">
        <omgdc:Bounds height="35" width="35" x="613" y="340"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="AddressValidationBoundaryErrorEvent" id="BPMNShape_AddressValidationBoundaryErrorEvent">
        <omgdc:Bounds height="30" width="30" x="510" y="365"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="resetAddressForm" id="BPMNShape_resetAddressForm">
        <omgdc:Bounds height="55" width="105" x="320" y="400"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="parallelgateway1" id="BPMNShape_parallelgateway1">
        <omgdc:Bounds height="40" width="40" x="790" y="257"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getPaymentModalities" id="BPMNShape_getPaymentModalities">
        <omgdc:Bounds height="55" width="105" x="890" y="160"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getCoupon" id="BPMNShape_getCoupon">
        <omgdc:Bounds height="55" width="105" x="830" y="420"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="couponValidation" id="BPMNShape_couponValidation" isExpanded="true">
        <omgdc:Bounds height="246" width="401" x="970" y="325"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent4" id="BPMNShape_startevent4">
        <omgdc:Bounds height="35" width="35" x="976" y="363"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent4" id="BPMNShape_endevent4">
        <omgdc:Bounds height="35" width="35" x="1310" y="363"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway2" id="BPMNShape_exclusivegateway2">
        <omgdc:Bounds height="40" width="40" x="1052" y="360"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway3" id="BPMNShape_exclusivegateway3">
        <omgdc:Bounds height="40" width="40" x="1230" y="360"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="validateCoupon" id="BPMNShape_validateCoupon">
        <omgdc:Bounds height="55" width="105" x="1020" y="440"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="calculateNewPrice" id="BPMNShape_calculateNewPrice">
        <omgdc:Bounds height="55" width="105" x="1198" y="440"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway6" id="BPMNShape_exclusivegateway6">
        <omgdc:Bounds height="40" width="40" x="1140" y="447"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="couponValidationErrorReport" id="BPMNShape_couponValidationErrorReport">
        <omgdc:Bounds height="55" width="105" x="1108" y="510"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="CouponValidationErrorEndEvent" id="BPMNShape_CouponValidationErrorEndEvent">
        <omgdc:Bounds height="35" width="35" x="1250" y="520"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="CouponValidationBoundaryErrorEvent" id="BPMNShape_CouponValidationBoundaryErrorEvent">
        <omgdc:Bounds height="30" width="30" x="990" y="555"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="resetCouponForm" id="BPMNShape_resetCouponForm">
        <omgdc:Bounds height="55" width="105" x="830" y="570"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="parallelgateway2" id="BPMNShape_parallelgateway2">
        <omgdc:Bounds height="40" width="40" x="1410" y="280"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent5" id="BPMNShape_endevent5">
        <omgdc:Bounds height="35" width="35" x="2870" y="283"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="paymentValidation" id="BPMNShape_paymentValidation" isExpanded="true">
        <omgdc:Bounds height="301" width="521" x="1510" y="150"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent5" id="BPMNShape_startevent5">
        <omgdc:Bounds height="35" width="35" x="1530" y="286"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent6" id="BPMNShape_endevent6">
        <omgdc:Bounds height="35" width="35" x="1980" y="286"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway4" id="BPMNShape_exclusivegateway4">
        <omgdc:Bounds height="40" width="40" x="1580" y="283"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway5" id="BPMNShape_exclusivegateway5">
        <omgdc:Bounds height="40" width="40" x="1920" y="283"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getBankTransferData" id="BPMNShape_getBankTransferData">
        <omgdc:Bounds height="55" width="105" x="1660" y="170"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getCreditCardData" id="BPMNShape_getCreditCardData">
        <omgdc:Bounds height="55" width="105" x="1660" y="384"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="validateBankTransferData" id="BPMNShape_validateBankTransferData">
        <omgdc:Bounds height="55" width="105" x="1780" y="170"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="bankTransferValidationErrorEndEvent" id="BPMNShape_bankTransferValidationErrorEndEvent">
        <omgdc:Bounds height="35" width="35" x="1860" y="233"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="validateCreditCardData" id="BPMNShape_validateCreditCardData">
        <omgdc:Bounds height="55" width="105" x="1790" y="384"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="creditCardValidationErrorEndEvent" id="BPMNShape_creditCardValidationErrorEndEvent">
        <omgdc:Bounds height="35" width="35" x="1860" y="340"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="PaymentValidationBoundaryErrorEvent" id="BPMNShape_PaymentValidationBoundaryErrorEvent">
        <omgdc:Bounds height="30" width="30" x="1730" y="440"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="resetPaymentValidation" id="BPMNShape_resetPaymentValidation">
        <omgdc:Bounds height="55" width="105" x="1490" y="474"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="debugOutput" id="BPMNShape_debugOutput">
        <omgdc:Bounds height="55" width="105" x="2050" y="273"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getAcknowledgement" id="BPMNShape_getAcknowledgement">
        <omgdc:Bounds height="55" width="105" x="2170" y="273"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway8" id="BPMNShape_exclusivegateway8">
        <omgdc:Bounds height="40" width="40" x="2290" y="280"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway9" id="BPMNShape_exclusivegateway9">
        <omgdc:Bounds height="40" width="40" x="2680" y="280"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sendOrderNotification" id="BPMNShape_sendOrderNotification">
        <omgdc:Bounds height="55" width="105" x="2740" y="273"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="payment" id="BPMNShape_payment" isExpanded="true">
        <omgdc:Bounds height="131" width="291" x="2370" y="235"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="retrievePaymentAcknowledgement" id="BPMNShape_retrievePaymentAcknowledgement">
        <omgdc:Bounds height="55" width="105" x="2430" y="265"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent6" id="BPMNShape_startevent6">
        <omgdc:Bounds height="35" width="35" x="2380" y="275"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="paymentErrorEndEvent" id="BPMNShape_paymentErrorEndEvent">
        <omgdc:Bounds height="35" width="35" x="2616" y="325"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent9" id="BPMNShape_endevent9">
        <omgdc:Bounds height="35" width="35" x="2616" y="275"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway10" id="BPMNShape_exclusivegateway10">
        <omgdc:Bounds height="40" width="40" x="2560" y="272"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="PaymentBoundaryErrorEvent" id="BPMNShape_PaymentBoundaryErrorEvent">
        <omgdc:Bounds height="30" width="30" x="2450" y="355"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent10" id="BPMNShape_endevent10">
        <omgdc:Bounds height="35" width="35" x="2447" y="423"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow2" id="BPMNEdge_flow2">
        <omgdi:waypoint x="175" y="277"></omgdi:waypoint>
        <omgdi:waypoint x="230" y="277"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow3" id="BPMNEdge_flow3">
        <omgdi:waypoint x="335" y="277"></omgdi:waypoint>
        <omgdi:waypoint x="400" y="277"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow5" id="BPMNEdge_flow5">
        <omgdi:waypoint x="320" y="427"></omgdi:waypoint>
        <omgdi:waypoint x="282" y="426"></omgdi:waypoint>
        <omgdi:waypoint x="282" y="305"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow7" id="BPMNEdge_flow7">
        <omgdi:waypoint x="751" y="277"></omgdi:waypoint>
        <omgdi:waypoint x="790" y="277"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow8" id="BPMNEdge_flow8">
        <omgdi:waypoint x="810" y="257"></omgdi:waypoint>
        <omgdi:waypoint x="810" y="187"></omgdi:waypoint>
        <omgdi:waypoint x="890" y="187"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow9" id="BPMNEdge_flow9">
        <omgdi:waypoint x="810" y="297"></omgdi:waypoint>
        <omgdi:waypoint x="810" y="448"></omgdi:waypoint>
        <omgdi:waypoint x="830" y="447"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow10" id="BPMNEdge_flow10">
        <omgdi:waypoint x="935" y="447"></omgdi:waypoint>
        <omgdi:waypoint x="970" y="448"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow19" id="BPMNEdge_flow19">
        <omgdi:waypoint x="882" y="570"></omgdi:waypoint>
        <omgdi:waypoint x="882" y="475"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow20" id="BPMNEdge_flow20">
        <omgdi:waypoint x="995" y="187"></omgdi:waypoint>
        <omgdi:waypoint x="1430" y="187"></omgdi:waypoint>
        <omgdi:waypoint x="1430" y="280"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow21" id="BPMNEdge_flow21">
        <omgdi:waypoint x="1371" y="448"></omgdi:waypoint>
        <omgdi:waypoint x="1430" y="448"></omgdi:waypoint>
        <omgdi:waypoint x="1430" y="320"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow30" id="BPMNEdge_flow30">
        <omgdi:waypoint x="1450" y="300"></omgdi:waypoint>
        <omgdi:waypoint x="1510" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow34" id="BPMNEdge_flow34">
        <omgdi:waypoint x="1490" y="501"></omgdi:waypoint>
        <omgdi:waypoint x="1462" y="500"></omgdi:waypoint>
        <omgdi:waypoint x="1462" y="326"></omgdi:waypoint>
        <omgdi:waypoint x="1510" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow35" id="BPMNEdge_flow35">
        <omgdi:waypoint x="2031" y="300"></omgdi:waypoint>
        <omgdi:waypoint x="2050" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow36" id="BPMNEdge_flow36">
        <omgdi:waypoint x="2155" y="300"></omgdi:waypoint>
        <omgdi:waypoint x="2170" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow40" id="BPMNEdge_flow40">
        <omgdi:waypoint x="2275" y="300"></omgdi:waypoint>
        <omgdi:waypoint x="2290" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow41" id="BPMNEdge_flow41">
        <omgdi:waypoint x="2310" y="280"></omgdi:waypoint>
        <omgdi:waypoint x="2309" y="189"></omgdi:waypoint>
        <omgdi:waypoint x="2699" y="189"></omgdi:waypoint>
        <omgdi:waypoint x="2700" y="280"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="42" width="100" x="10" y="0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow42" id="BPMNEdge_flow42">
        <omgdi:waypoint x="2720" y="300"></omgdi:waypoint>
        <omgdi:waypoint x="2740" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow43" id="BPMNEdge_flow43">
        <omgdi:waypoint x="2845" y="300"></omgdi:waypoint>
        <omgdi:waypoint x="2870" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow44" id="BPMNEdge_flow44">
        <omgdi:waypoint x="2330" y="300"></omgdi:waypoint>
        <omgdi:waypoint x="2370" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow49" id="BPMNEdge_flow49">
        <omgdi:waypoint x="2661" y="300"></omgdi:waypoint>
        <omgdi:waypoint x="2680" y="300"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape bpmnElement="endevent7" id="BPMNShape_endevent7">
        <omgdc:Bounds height="35" width="35" x="2960" y="318"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow52" id="BPMNEdge_flow52">
        <omgdi:waypoint x="1213" y="537"></omgdi:waypoint>
        <omgdi:waypoint x="1250" y="537"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow45" id="BPMNEdge_flow45">
        <omgdi:waypoint x="2415" y="292"></omgdi:waypoint>
        <omgdi:waypoint x="2430" y="292"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="errorPayment" id="BPMNEdge_errorPayment">
        <omgdi:waypoint x="2580" y="312"></omgdi:waypoint>
        <omgdi:waypoint x="2580" y="342"></omgdi:waypoint>
        <omgdi:waypoint x="2616" y="342"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="-13" y="4"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="successPayment" id="BPMNEdge_successPayment">
        <omgdi:waypoint x="2600" y="292"></omgdi:waypoint>
        <omgdi:waypoint x="2616" y="292"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow48" id="BPMNEdge_flow48">
        <omgdi:waypoint x="2535" y="292"></omgdi:waypoint>
        <omgdi:waypoint x="2560" y="292"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow39" id="BPMNEdge_flow39">
        <omgdi:waypoint x="595" y="279"></omgdi:waypoint>
        <omgdi:waypoint x="610" y="279"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow38" id="BPMNEdge_flow38">
        <omgdi:waypoint x="1125" y="467"></omgdi:waypoint>
        <omgdi:waypoint x="1140" y="467"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="successCreditCardValidation" id="BPMNEdge_successCreditCardValidation">
        <omgdi:waypoint x="1895" y="411"></omgdi:waypoint>
        <omgdi:waypoint x="1939" y="410"></omgdi:waypoint>
        <omgdi:waypoint x="1940" y="323"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="10" y="0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="errorCreditCardValidation" id="BPMNEdge_errorCreditCardValidation">
        <omgdi:waypoint x="1842" y="384"></omgdi:waypoint>
        <omgdi:waypoint x="1841" y="357"></omgdi:waypoint>
        <omgdi:waypoint x="1860" y="357"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="-41" y="0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="creditCardMethod" id="BPMNEdge_creditCardMethod">
        <omgdi:waypoint x="1600" y="323"></omgdi:waypoint>
        <omgdi:waypoint x="1599" y="411"></omgdi:waypoint>
        <omgdi:waypoint x="1660" y="411"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="1" y="-46"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow24" id="BPMNEdge_flow24">
        <omgdi:waypoint x="1565" y="303"></omgdi:waypoint>
        <omgdi:waypoint x="1580" y="303"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow25" id="BPMNEdge_flow25">
        <omgdi:waypoint x="1960" y="303"></omgdi:waypoint>
        <omgdi:waypoint x="1980" y="303"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow26" id="BPMNEdge_flow26">
        <omgdi:waypoint x="1765" y="197"></omgdi:waypoint>
        <omgdi:waypoint x="1780" y="197"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="bankTransferMethod" id="BPMNEdge_bankTransferMethod">
        <omgdi:waypoint x="1600" y="283"></omgdi:waypoint>
        <omgdi:waypoint x="1600" y="197"></omgdi:waypoint>
        <omgdi:waypoint x="1660" y="197"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="42" width="100" x="10" y="0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="errorBankTransferValidation" id="BPMNEdge_errorBankTransferValidation">
        <omgdi:waypoint x="1832" y="225"></omgdi:waypoint>
        <omgdi:waypoint x="1834" y="250"></omgdi:waypoint>
        <omgdi:waypoint x="1860" y="250"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="-24" y="4"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="successBankTransferValidation" id="BPMNEdge_successBankTransferValidation">
        <omgdi:waypoint x="1885" y="197"></omgdi:waypoint>
        <omgdi:waypoint x="1940" y="197"></omgdi:waypoint>
        <omgdi:waypoint x="1940" y="283"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="10" y="0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow31" id="BPMNEdge_flow31">
        <omgdi:waypoint x="1765" y="411"></omgdi:waypoint>
        <omgdi:waypoint x="1789" y="410"></omgdi:waypoint>
        <omgdi:waypoint x="1790" y="411"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="billingMethod" id="BPMNEdge_billingMethod">
        <omgdi:waypoint x="1620" y="303"></omgdi:waypoint>
        <omgdi:waypoint x="1920" y="303"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="10" y="0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow6" id="BPMNEdge_flow6">
        <omgdi:waypoint x="455" y="279"></omgdi:waypoint>
        <omgdi:waypoint x="490" y="279"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="successAddressValidation" id="BPMNEdge_successAddressValidation">
        <omgdi:waypoint x="650" y="279"></omgdi:waypoint>
        <omgdi:waypoint x="690" y="279"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="errorAddressValidation" id="BPMNEdge_errorAddressValidation">
        <omgdi:waypoint x="630" y="299"></omgdi:waypoint>
        <omgdi:waypoint x="630" y="340"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="10" y="0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow11" id="BPMNEdge_flow11">
        <omgdi:waypoint x="1011" y="380"></omgdi:waypoint>
        <omgdi:waypoint x="1052" y="380"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="hasNoHash" id="BPMNEdge_noHash">
        <omgdi:waypoint x="1092" y="380"></omgdi:waypoint>
        <omgdi:waypoint x="1230" y="380"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="0" y="4"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
        <omgdi:waypoint x="1270" y="380"></omgdi:waypoint>
        <omgdi:waypoint x="1310" y="380"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="hasHash" id="BPMNEdge_hash">
        <omgdi:waypoint x="1072" y="400"></omgdi:waypoint>
        <omgdi:waypoint x="1072" y="440"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14" width="100" x="10" y="0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="errorCouponValidation" id="BPMNEdge_errorCouponValidation">
        <omgdi:waypoint x="1160" y="487"></omgdi:waypoint>
        <omgdi:waypoint x="1160" y="510"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="42" width="100" x="10" y="-8"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="successCouponValidation" id="BPMNEdge_successCouponValidation">
        <omgdi:waypoint x="1180" y="467"></omgdi:waypoint>
        <omgdi:waypoint x="1198" y="467"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow17" id="BPMNEdge_flow17">
        <omgdi:waypoint x="1250" y="440"></omgdi:waypoint>
        <omgdi:waypoint x="1250" y="400"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow1" id="BPMNEdge_flow1">
        <omgdi:waypoint x="45" y="335"></omgdi:waypoint>
        <omgdi:waypoint x="120" y="335"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow4" id="BPMNEdge_flow4">
        <omgdi:waypoint x="525" y="395"></omgdi:waypoint>
        <omgdi:waypoint x="524" y="427"></omgdi:waypoint>
        <omgdi:waypoint x="425" y="427"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow18" id="BPMNEdge_flow18">
        <omgdi:waypoint x="1005" y="585"></omgdi:waypoint>
        <omgdi:waypoint x="1003" y="597"></omgdi:waypoint>
        <omgdi:waypoint x="935" y="597"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow33" id="BPMNEdge_flow33">
        <omgdi:waypoint x="1745" y="470"></omgdi:waypoint>
        <omgdi:waypoint x="1744" y="501"></omgdi:waypoint>
        <omgdi:waypoint x="1595" y="501"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow37" id="BPMNEdge_flow37">
        <omgdi:waypoint x="2931" y="335"></omgdi:waypoint>
        <omgdi:waypoint x="2960" y="335"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow53" id="BPMNEdge_flow53">
        <omgdi:waypoint x="2465" y="385"></omgdi:waypoint>
        <omgdi:waypoint x="2464" y="423"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>